<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JurisFeed</title>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <style>
        :root { --primary: #1d9bf0; --bg: #000000; --card: #16181c; --text: #e7e9ea; --gray: #71767b; --border: #2f3336; }
        body { background: var(--bg); color: var(--text); font-family: -apple-system, sans-serif; margin: 0; padding-bottom: 60px; }
        
        /* Layout Mobile-First */
        .header { position: sticky; top: 0; background: rgba(0,0,0,0.8); backdrop-filter: blur(5px); padding: 15px; border-bottom: 1px solid var(--border); z-index: 99; text-align: center; font-weight: bold; font-size: 1.2rem; }
        .tabs { display: flex; border-bottom: 1px solid var(--border); }
        .tab { flex: 1; padding: 15px; text-align: center; cursor: pointer; font-weight: bold; color: var(--gray); position: relative; }
        .tab.active { color: var(--text); }
        .tab.active::after { content: ''; position: absolute; bottom: 0; left: 25%; width: 50%; height: 4px; background: var(--primary); border-radius: 2px; }
        
        /* Feed */
        .feed { max-width: 600px; margin: 0 auto; min-height: 100vh; border-left: 1px solid var(--border); border-right: 1px solid var(--border); }
        
        /* Post Style */
        .post { padding: 15px; border-bottom: 1px solid var(--border); display: flex; gap: 12px; transition: 0.2s; }
        .post:hover { background: rgba(255,255,255,0.03); }
        
        .avatar { width: 48px; height: 48px; border-radius: 50%; background: #333; display: flex; align-items: center; justify-content: center; font-weight: bold; flex-shrink: 0; border: 2px solid transparent; }
        
        /* Cores dos Perfis */
        .p-stf { border-color: #ffe082; color: #ffe082; }
        .p-stj { border-color: #ef9a9a; color: #ef9a9a; }
        .p-penal { border-color: #ce93d8; color: #ce93d8; }
        .p-civil { border-color: #90caf9; color: #90caf9; }

        .content { width: 100%; }
        .meta { display: flex; justify-content: space-between; color: var(--gray); font-size: 0.9rem; margin-bottom: 4px; }
        .author { font-weight: bold; color: var(--text); margin-right: 5px; }
        .handle { color: var(--gray); }
        .text { font-size: 1rem; line-height: 1.5; margin-bottom: 10px; white-space: pre-wrap; }
        .actions { display: flex; justify-content: space-between; color: var(--gray); max-width: 80%; }
        .material-icons { font-size: 18px; cursor: pointer; }
        .material-icons:hover { color: var(--primary); }
        
        .loading { text-align: center; padding: 20px; color: var(--gray); }
    </style>
</head>
<body>

    <div class="feed">
        <div class="header">JurisFeed</div>
        
        <div class="tabs">
            <div class="tab active" onclick="filtrar('geral', this)">Feed Geral</div>
            <div class="tab" onclick="filtrar('updates', this)">üî• Atualiza√ß√µes</div>
        </div>

        <div id="posts-container">
            <div class="loading">Buscando atualiza√ß√µes nos Tribunais...</div>
        </div>
    </div>

    <script>
        let todosPosts = [];

        // 1. Defini√ß√£o dos Perfis (A "Persona" de cada Lei)
        const perfis = {
            'stf': { nome: 'Supremo Tribunal Federal', handle: '@stf_oficial', css: 'p-stf' },
            'stj': { nome: 'Superior Tribunal de Justi√ßa', handle: '@stj_cidadania', css: 'p-stj' },
            'cp':  { nome: 'C√≥digo Penal', handle: '@decreto_2848', css: 'p-penal' },
            'cpc': { nome: 'Processo Civil', handle: '@lei_13105', css: 'p-civil' },
            'default': { nome: 'Sistema Jur√≠dico', handle: '@legislacao', css: '' }
        };

        // 2. Carregar Dados (Tenta ler o JSON gerado pelo Python, sen√£o usa backup)
        async function carregarDados() {
            try {
                // Tenta buscar o arquivo gerado pelo rob√¥
                const res = await fetch('db.json'); 
                if (!res.ok) throw new Error("Sem dados");
                const data = await res.json();
                todosPosts = data;
            } catch (e) {
                // Dados de Exemplo (Fallback inicial)
                todosPosts = [
                    { perfil: 'cp', texto: 'Art. 121: Matar algu√©m. Pena: reclus√£o, de seis a vinte anos.', data: new Date().toISOString() },
                    { perfil: 'cpc', texto: 'Lembrete: Os prazos processuais s√£o contados em dias √∫teis (Art. 219).', data: new Date().toISOString() }
                ];
            }
            renderizar(todosPosts);
        }

        // 3. Renderizar na Tela
        function renderizar(lista) {
            const container = document.getElementById('posts-container');
            container.innerHTML = '';

            lista.forEach(post => {
                const p = perfis[post.perfil] || perfis['default'];
                const dataFormatada = new Date(post.data).toLocaleDateString('pt-BR');

                const html = `
                    <div class="post">
                        <div class="avatar ${p.css}">${p.nome.substring(0,1)}</div>
                        <div class="content">
                            <div class="meta">
                                <div><span class="author">${p.nome}</span> <span class="handle">${p.handle}</span></div>
                                <span>${dataFormatada}</span>
                            </div>
                            <div class="text">${post.texto}</div>
                            <div class="actions">
                                <i class="material-icons">chat_bubble_outline</i>
                                <i class="material-icons">repeat</i>
                                <i class="material-icons">favorite_border</i>
                                <i class="material-icons">share</i>
                            </div>
                        </div>
                    </div>
                `;
                container.innerHTML += html;
            });
        }

        // 4. Filtros
        function filtrar(tipo, el) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            el.classList.add('active');

            if (tipo === 'updates') {
                // Filtra STF e STJ (que v√™m do rob√¥)
                const updates = todosPosts.filter(p => p.perfil === 'stf' || p.perfil === 'stj');
                renderizar(updates);
            } else {
                renderizar(todosPosts);
            }
        }

        // In√≠cio
        carregarDados();
    </script>
</body>
</html>
